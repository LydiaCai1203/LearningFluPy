# 深入浅出索引(上)

[TOC]
    提高数据查询的效率。
-----------------------------------
## 索引常见的模型
### 哈希表
    所以hash表只适用于等值查询的场景。比如Memchached或者是其它一些NoSQL引擎。
#### 优点
    1. insert数据 或者是 delete数据的时候 速度会很快
#### 缺点
    1. 由于hash表的key是无序的，所以在做区间查询的时候会很慢，因为会进行全表扫描；

### 有序数组
    有序数组索引只适用于静态存储引擎。
#### 优点
    1. 不论是在范围查询还是等值查询，效率都很高，使用二分法进行搜索只需要O(log(N))
#### 缺点
    1. insert和delet时候的效率都低，insert的时候要插入位置以后的所有元素都后移。delete同理。

### 树

#### 二叉树平衡树
##### 二叉平衡树的搜索效率是最高的，但实际情况中不使用
    索引不仅仅存在于内存中，也存在在磁盘上。当结点很多的时候，导致树高较大。访问一次数据块的时间可能是10ms,那就可能导致
    一次查询的时间达到10*h ms。因此为了尽量减少对磁盘的访问，这里应该尽量减小树高。因此选择N叉树才是合理的。

#### N叉平衡树
##### N 叉树由于在读写上的性能优点，以及适配磁盘的访问模式，已经广泛被应用在数据库引擎当中
    这里的N其实就是数据块的大小，树根的数据块总是存在于内存中，考虑到N叉树的树高小，所以最多要访问磁盘的次数要少很多。

#### InnoDB的存储引擎
    B+Tree， 表都是根据主键顺序以索引的形式存放的，这种存储方式的表称为索引组织表。

```mysql
create table T(
    id int primary key,
    k int not null,
    name varchar(16),
    index(k)
)engine=InnoDB;
```
![InnoDB索引组织结构](https://github.com/LydiaCai1203/leetcode-practice/blob/master/statics/Innodb%E7%B4%A2%E5%BC%95%E7%BB%84%E7%BB%87%E7%BB%93%E6%9E%84.jpg)

##### 主键索引(聚簇索引) 应尽量使用主键索引
    叶子结点存的是整行的数据。
##### 非主键索引(二级索引)
    叶子结点存的是主键的数据。

##### 主键索引 和 非主键索引 在查询时候的区别
```mysql
// 只需要搜索左边这棵树
select * from T where ID=5;

// 先搜索右边的树，搜到ID=500的值以后，再去搜索左边的树，这个过程叫做回表
select * from T where k=5;
```

